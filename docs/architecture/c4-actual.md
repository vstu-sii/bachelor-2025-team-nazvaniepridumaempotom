# Подтверждение архитектуры

## 1. Документирование фактических решений

**Текущая архитектура:**
┌─────────────────┐ HTTP ┌─────────────────────┐
│ Пользователь │───────────►│ FastAPI Server │
│ (API Client) │◄───────────│ (127.0.0.1:8001) │
└─────────────────┘ └──────────┬──────────┘
│
│ Subprocess
▼
┌─────────────────────┐
│ Ollama Service │
│ (llava + llama3.2) │
└─────────────────────┘


**Компоненты:**
1. **FastAPI Application:** `main.py` с тремя endpoint'ами
2. **LLM Integration:** Прямой вызов Ollama через subprocess
3. **Хранение:** Временные структуры данных в памяти Python

## 2.2. ADR (Architecture Decision Record)

### ADR-001: Использование монолитной архитектуры для прототипа
- **Контекст:** Необходимость быстрого прототипирования с ограниченными ресурсами
- **Решение:** Единое FastAPI приложение вместо микросервисов
- **Последствия:**
  -  Быстрая разработка и деплой
  -  Проще отладка
  -  Сложнее масштабировать отдельные компоненты
  -  Риск создания spaghetti-кода

### ADR-002: Синхронная обработка LLM-запросов
- **Контекст:** Ограниченное время на реализацию прототипа
- **Решение:** Синхронные HTTP-запросы к Ollama
- **Последствия:**
  -  Простая реализация
  -  Прямая обработка ошибок
  -  Блокировка при одновременных запросах
  -  Низкая отзывчивость при высокой нагрузке

### ADR-003: Хранение в памяти вместо БД
- **Контекст:** Прототип для демонстрации, не для production
- **Решение:** Использование Python dict для временного хранения
- **Последствия:**
  -  Нет настройки БД
  -  Максимальная скорость
  -  Потеря данных при сбое
  -  Невозможность анализа истории

## 2.3. Схема интеграции компонентов
[component_integration.png]

Потоки данных:

Изображение → llava: Анализ визуальных характеристик

Текст → llama3.2: Анализ соответствия рецепту

Объединенный результат: Форматирование для клиента
